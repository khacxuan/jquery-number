(function(e){"use strict";function t(e,t){if(this.createTextRange){var a=this.createTextRange();a.collapse(!0),a.moveStart("character",e),a.moveEnd("character",t-e),a.select()}else this.setSelectionRange&&(this.focus(),this.setSelectionRange(e,t))}function a(e){var t=this.value.length;if(e="start"==e.toLowerCase()?"Start":"End",document.selection){var a,i,n,l=document.selection.createRange();return a=l.duplicate(),a.expand("textedit"),a.setEndPoint("EndToEnd",l),i=a.text.length-l.text.length,n=i+l.text.length,"Start"==e?i:n}return"undefined"!=typeof this["selection"+e]&&(t=this["selection"+e]),t}var i=function(e,t){function a(t){var a=e(t).replace(/\u2019/g,"'").replace(/\u201D/g,'"').replace(/\u3000/g," ").replace(/\uFFE5/g,"Â¥").replace(/[\uFF01\uFF03-\uFF06\uFF08\uFF09\uFF0C-\uFF19\uFF1C-\uFF1F\uFF21-\uFF3B\uFF3D\uFF3F\uFF41-\uFF5B\uFF5D\uFF5E]/g,i);return a=a.replace(/\u2212/g,"-").replace(/\u30fc/g,"-")}function i(e){return t(e.charCodeAt(0)-65248)}return a}(String,String.fromCharCode),n={codes:{46:127,188:44,109:45,190:46,191:47,192:96,220:92,222:39,221:93,219:91,173:45,187:61,186:59,189:45,110:46},shifts:{96:"~",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",48:")",45:"_",61:"+",91:"{",93:"}",92:"|",59:":",39:'"',44:"<",46:">",47:"?"}};e.fn.number=function(i,l,r,u){u="undefined"==typeof u?",":u,r="undefined"==typeof r?".":r,l="undefined"==typeof l?0:l;var s="\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4),c=new RegExp("[^"+s+"0-9]","g"),h=new RegExp(s,"g"),o=!1;return i===!0?this.is("input:text")?this.on({"keydown.format":function(i){var s=e(this),c=s.data("numFormat"),h=i.keyCode?i.keyCode:i.which,v="",d=a.apply(this,["start"]),p=a.apply(this,["end"]),f="",g=!1;if(229===h)return o=!0,!1;if(o=!1,n.codes.hasOwnProperty(h)&&(h=n.codes[h]),!i.shiftKey&&h>=65&&h<=90?h+=32:!i.shiftKey&&h>=69&&h<=105?h-=48:i.shiftKey&&n.shifts.hasOwnProperty(h)&&(v=n.shifts[h]),""==v&&(v=String.fromCharCode(h)),8!=h&&45!=h&&127!=h&&v!=r&&!v.match(/[0-9]/)){var F=i.keyCode?i.keyCode:i.which;if(46==F||8==F||127==F||9==F||27==F||13==F||(65==F||82==F||80==F||83==F||70==F||72==F||66==F||74==F||84==F||90==F||61==F||173==F||48==F)&&(i.ctrlKey||i.metaKey)===!0||(86==F||67==F||88==F)&&(i.ctrlKey||i.metaKey)===!0||F>=35&&F<=39||F>=112&&F<=123)return;return i.preventDefault(),!1}if(0==d&&p==this.value.length?8==h?(d=p=1,this.value="",c.init=l>0?-1:0,c.c=l>0?-(l+1):0,t.apply(this,[0,0])):v==r?(d=p=1,this.value="0"+r+new Array(l+1).join("0"),c.init=l>0?1:0,c.c=l>0?-(l+1):0):45==h?(d=p=2,this.value="-0"+r+new Array(l+1).join("0"),c.init=l>0?1:0,c.c=l>0?-(l+1):0,t.apply(this,[2,2])):(c.init=l>0?-1:0,c.c=l>0?-l:0):c.c=p-this.value.length,c.isPartialSelection=d!=p,l>0&&v==r&&d==this.value.length-l-1)c.c++,c.init=Math.max(0,c.init),i.preventDefault(),g=this.value.length+c.c;else if(45!=h||0==d&&0!=this.value.indexOf("-"))if(v==r)c.init=Math.max(0,c.init),i.preventDefault();else if(l>0&&127==h&&d==this.value.length-l-1)i.preventDefault();else if(l>0&&8==h&&d==this.value.length-l)i.preventDefault(),c.c--,g=this.value.length+c.c;else if(l>0&&127==h&&d>this.value.length-l-1){if(""===this.value)return;"0"!=this.value.slice(d,d+1)&&(f=this.value.slice(0,d)+"0"+this.value.slice(d+1),s.val(f)),i.preventDefault(),g=this.value.length+c.c}else if(l>0&&8==h&&d>this.value.length-l){if(""===this.value)return;"0"!=this.value.slice(d-1,d)&&(f=this.value.slice(0,d-1)+"0"+this.value.slice(d),s.val(f)),i.preventDefault(),c.c--,g=this.value.length+c.c}else 127==h&&this.value.slice(d,d+1)==u?i.preventDefault():8==h&&this.value.slice(d-1,d)==u?(i.preventDefault(),c.c--,g=this.value.length+c.c):l>0&&d==p&&this.value.length>l+1&&d>this.value.length-l-1&&isFinite(+v)&&!i.metaKey&&!i.ctrlKey&&!i.altKey&&1===v.length&&(f=p===this.value.length?this.value.slice(0,d-1):this.value.slice(0,d)+this.value.slice(d+1),this.value=f,g=d);else i.preventDefault();g!==!1&&t.apply(this,[g,g]),s.data("numFormat",c)},"keyup.format":function(i){var n,r=e(this),u=r.data("numFormat"),s=i.keyCode?i.keyCode:i.which,c=a.apply(this,["start"]),h=a.apply(this,["end"]);if(o===!0){if(13!==s)return!1;r.val(r.val()),o=!1}0!==c||0!==h||189!==s&&109!==s||(r.val("-"+r.val()),c=1,u.c=1-this.value.length,u.init=1,r.data("numFormat",u),n=this.value.length+u.c,t.apply(this,[n,n])),""===this.value||(s<48||s>57)&&(s<96||s>105)&&8!==s&&46!==s&&110!==s||(r.val(r.val()),l>0&&(u.init<1?(c=this.value.length-l-(u.init<0?1:0),u.c=c-this.value.length,u.init=1,r.data("numFormat",u)):c>this.value.length-l&&8!=s&&(u.c++,r.data("numFormat",u))),46!=s||u.isPartialSelection||(u.c++,r.data("numFormat",u)),n=this.value.length+u.c,t.apply(this,[n,n]))},"paste.format":function(t){var a=e(this),i=t.originalEvent,n=null;return window.clipboardData&&window.clipboardData.getData?n=window.clipboardData.getData("Text"):i.clipboardData&&i.clipboardData.getData&&(n=i.clipboardData.getData("text/plain")),a.val(n),t.preventDefault(),!1}}).each(function(){var t=e(this).data("numFormat",{c:-(l+1),decimals:l,thousands_sep:u,dec_point:r,regex_dec_num:c,regex_dec:h,init:!!this.value.indexOf(".")});""!==this.value&&t.val(t.val())}):this.each(function(){var t=e(this),a=+t.text().replace(c,"").replace(h,".");t.number(isFinite(a)?+a:0,l,r,u)}):this.text(e.number.apply(window,arguments))};var l=null,r=null;e.isPlainObject(e.valHooks.text)?(e.isFunction(e.valHooks.text.get)&&(l=e.valHooks.text.get),e.isFunction(e.valHooks.text.set)&&(r=e.valHooks.text.set)):e.valHooks.text={},e.valHooks.text.get=function(t){var a,n=e(t),r=n.data("numFormat");return r?""===t.value?"":(a=+i(t.value).replace(r.regex_dec_num,"").replace(r.regex_dec,"."),(0===i(t.value).indexOf("-")?"-":"")+(isFinite(a)?a:0)):e.isFunction(l)?l(t):void 0},e.valHooks.text.set=function(t,a){var i=e(t),n=i.data("numFormat");if(n){var l=e.number(a,n.decimals,n.dec_point,n.thousands_sep);return e.isFunction(r)?r(t,l):t.value=l}return e.isFunction(r)?r(t,a):void 0},e.number=function(e,t,a,n){n="undefined"==typeof n?"1000"!==new Number(1e3).toLocaleString()?new Number(1e3).toLocaleString().charAt(1):"":n,a="undefined"==typeof a?new Number(.1).toLocaleString().charAt(1):a,t=isFinite(+t)?Math.abs(t):0;var l="\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4),r="\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4);e=(i(e)+"").replace(".",a).replace(new RegExp(r,"g"),"").replace(new RegExp(l,"g"),".").replace(new RegExp("[^0-9+-Ee.]","g"),"");var u=isFinite(+e)?+e:0,s="",c=function(e,t){return""+ +(Math.round((""+e).indexOf("e")>0?e:e+"e+"+t)+"e-"+t)};return s=(t?c(u,t):""+Math.round(u)).split("."),s[0].length>3&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,n)),(s[1]||"").length<t&&(s[1]=s[1]||"",s[1]+=new Array(t-s[1].length+1).join("0")),s.join(a)}})(jQuery);